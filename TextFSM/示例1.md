# 网络工程师的Python之路 -- TextFSM模板创建教程



## TextFSM模板的创建和应用

- 每个变量后面有它自己对应的正则表达式模式（pattern），这些模式写在括号（）中。比如变量VLAN_ID顾名思义是要去匹配VLAN的ID号的，所以它后面的正则表达式模式写为（\d+），\d这个特殊序列用来匹配数字，后面的+用来做贪婪匹配。同理，NAME这个变量是用来匹配VLAN的名称的，因为这里VLAN的名称参杂了字母和数字，比如VLAN0002， 因此它的正则表达式模式写为（\w+），\w这个特殊序列用来匹配字母或数字，配合后面的+用来做贪婪匹配。同理，变量STATUS（\w+）用来匹配VLAN状态，VLAN状态会有active和inactive之分。



- 在定义好变量后，我们使用Start语句来定义匹配规则，匹配规则由正则表达式的模式以及我们的变量名组成:

```text
 Start
  ^${VLAN_ID}\s+${NAME}\s+${STATUS}\s+ -> Record
```

- **Start语句后面必须以正则表达式^开头**，^是正则表达式中的一种特殊字符，它用于匹配输入字符串的开始位置，**注意紧随其后的$不是正则表达式里的$**，**它的作用并不是用来匹配输入字符串的结尾位置**。**而是用来调用我们之前设置好的VLAN_ID并匹配该变量**（注意在TextFSM中调用变量的时候可以用大括号{}，写成${VLAN_ID}，也可以不调用，写成$VLAN_ID，但是TextFSM官方推荐使用大括号），而VLAN_ID对应的正则表达式恰巧是\d+，这样就匹配到了1，2，3，4，5，6，7，8这些VLAN ID，而后面的\s+$则表示匹配1，2，3，4，5，6，7，8后面的空格字符（\s这个特殊序列用来匹配空格字符）